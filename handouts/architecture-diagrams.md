# Architecture Diagrams Reference
## DW-104: Microsoft 365 Agents Pro-Code Training

---

## 1. Microsoft AI Stack Overview

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           USER INTERFACES                                    │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐      │
│  │  Teams   │  │ Outlook  │  │   Word   │  │  Excel   │  │ Web Apps │      │
│  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘      │
└───────┼─────────────┼─────────────┼─────────────┼─────────────┼────────────┘
        │             │             │             │             │
        └─────────────┴─────────────┼─────────────┴─────────────┘
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        MICROSOFT 365 COPILOT                                 │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │                        Orchestration Layer                              │ │
│  │   ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐              │ │
│  │   │ Grounding│  │ Reasoning│  │ Planning │  │ Actions  │              │ │
│  │   └──────────┘  └──────────┘  └──────────┘  └──────────┘              │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                    │                                         │
│  ┌────────────────────────────────┼────────────────────────────────────┐   │
│  │                     EXTENSIBILITY LAYER                              │   │
│  │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                 │   │
│  │   │ Declarative │  │   Message   │  │   Custom    │                 │   │
│  │   │   Agents    │  │ Extensions  │  │Engine Agents│                 │   │
│  │   └─────────────┘  └─────────────┘  └─────────────┘                 │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
        ┌───────────────────────────┼───────────────────────────┐
        ▼                           ▼                           ▼
┌───────────────────┐  ┌───────────────────┐  ┌───────────────────┐
│  MICROSOFT GRAPH  │  │   AZURE OPENAI    │  │   COPILOT STUDIO  │
│  ┌─────────────┐  │  │  ┌─────────────┐  │  │  ┌─────────────┐  │
│  │ Users/Groups│  │  │  │   GPT-4o    │  │  │  │  Low-Code   │  │
│  │   Files     │  │  │  │ Embeddings  │  │  │  │  Pro-Code   │  │
│  │   Mail      │  │  │  │  DALL-E 3   │  │  │  │    MCP      │  │
│  │  Calendar   │  │  │  └─────────────┘  │  │  └─────────────┘  │
│  └─────────────┘  │  └───────────────────┘  └───────────────────┘
└───────────────────┘
```

---

## 2. Declarative Agent Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         DECLARATIVE AGENT                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   ┌──────────────────────────────────────────────────────────────────────┐  │
│   │                     manifest.json (Teams App)                         │  │
│   │  • App ID, Name, Description                                          │  │
│   │  • Permissions & Scopes                                               │  │
│   │  • Bot Configuration                                                  │  │
│   └──────────────────────────────────────────────────────────────────────┘  │
│                                    │                                         │
│                                    ▼                                         │
│   ┌──────────────────────────────────────────────────────────────────────┐  │
│   │                  declarativeAgent.json                                │  │
│   │  ┌────────────────────────────────────────────────────────────────┐  │  │
│   │  │ Instructions (System Prompt)                                    │  │  │
│   │  │ • Role & Purpose                                                │  │  │
│   │  │ • Personality & Tone                                            │  │  │
│   │  │ • Knowledge Boundaries                                          │  │  │
│   │  │ • Response Guidelines                                           │  │  │
│   │  │ • Safety Rules                                                  │  │  │
│   │  └────────────────────────────────────────────────────────────────┘  │  │
│   │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐               │  │
│   │  │ Capabilities │  │   Actions    │  │ Conv Starters│               │  │
│   │  │ • WebSearch  │  │ → ai-plugin  │  │ • Examples   │               │  │
│   │  │ • CodeInterp │  │   .json      │  │ • Prompts    │               │  │
│   │  └──────────────┘  └──────┬───────┘  └──────────────┘               │  │
│   └─────────────────────────────┼────────────────────────────────────────┘  │
│                                 │                                            │
│                                 ▼                                            │
│   ┌──────────────────────────────────────────────────────────────────────┐  │
│   │                       ai-plugin.json                                  │  │
│   │  ┌──────────────────────────────────────────────────────────────┐   │  │
│   │  │                      Functions                                │   │  │
│   │  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │   │  │
│   │  │  │ getStatus()  │  │ createItem() │  │ searchDocs() │       │   │  │
│   │  │  └──────────────┘  └──────────────┘  └──────────────┘       │   │  │
│   │  └──────────────────────────────────────────────────────────────┘   │  │
│   │  ┌──────────────────────────────────────────────────────────────┐   │  │
│   │  │                       Runtime                                 │   │  │
│   │  │  Type: OpenAPI    Auth: OAuth/API Key    Spec: openapi.yaml  │   │  │
│   │  └──────────────────────────────────────────────────────────────┘   │  │
│   └──────────────────────────────────────────────────────────────────────┘  │
│                                 │                                            │
└─────────────────────────────────┼────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                          BACKEND API                                         │
│   ┌──────────────────┐  ┌──────────────────┐  ┌──────────────────┐         │
│   │  Azure Function  │  │  App Service     │  │  External API    │         │
│   │  (Serverless)    │  │  (Web App)       │  │  (3rd Party)     │         │
│   └──────────────────┘  └──────────────────┘  └──────────────────┘         │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 3. Custom Engine Agent Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      CUSTOM ENGINE AGENT                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   ┌──────────────────────────────────────────────────────────────────────┐  │
│   │                        Teams Bot Handler                              │  │
│   │   onMessage() → Orchestrator → Response                               │  │
│   └────────────────────────────────┬─────────────────────────────────────┘  │
│                                    │                                         │
│                                    ▼                                         │
│   ┌──────────────────────────────────────────────────────────────────────┐  │
│   │                         ORCHESTRATOR                                  │  │
│   │  ┌─────────────────────────────────────────────────────────────────┐ │  │
│   │  │                    Agent Loop (Observe → Think → Act)            │ │  │
│   │  │                                                                   │ │  │
│   │  │  ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐  │ │  │
│   │  │  │ Receive  │───▶│ Reason   │───▶│ Select   │───▶│ Execute  │  │ │  │
│   │  │  │  Input   │    │ (LLM)    │    │  Tool    │    │  Action  │  │ │  │
│   │  │  └──────────┘    └──────────┘    └──────────┘    └────┬─────┘  │ │  │
│   │  │                                                        │        │ │  │
│   │  │  ┌───────────────────────────────────────────────────┘        │ │  │
│   │  │  │                                                              │ │  │
│   │  │  │  ┌──────────┐    ┌──────────┐    ┌──────────┐              │ │  │
│   │  │  └─▶│ Process  │───▶│ Format   │───▶│ Respond  │              │ │  │
│   │  │     │ Result   │    │ Output   │    │ to User  │              │ │  │
│   │  │     └──────────┘    └──────────┘    └──────────┘              │ │  │
│   │  └─────────────────────────────────────────────────────────────────┘ │  │
│   └──────────────────────────────────────────────────────────────────────┘  │
│                                    │                                         │
│        ┌───────────────────────────┼───────────────────────────┐            │
│        │                           │                           │            │
│        ▼                           ▼                           ▼            │
│   ┌─────────────┐           ┌─────────────┐           ┌─────────────┐      │
│   │   MEMORY    │           │   PLANNER   │           │  PLUGINS    │      │
│   │ ┌─────────┐ │           │ ┌─────────┐ │           │ ┌─────────┐ │      │
│   │ │ Short   │ │           │ │ Task    │ │           │ │ Search  │ │      │
│   │ │ Term    │ │           │ │ Decomp  │ │           │ │ Plugin  │ │      │
│   │ └─────────┘ │           │ └─────────┘ │           │ └─────────┘ │      │
│   │ ┌─────────┐ │           │ ┌─────────┐ │           │ ┌─────────┐ │      │
│   │ │ Long    │ │           │ │ Step    │ │           │ │ Summary │ │      │
│   │ │ Term    │ │           │ │ Planner │ │           │ │ Plugin  │ │      │
│   │ └─────────┘ │           │ └─────────┘ │           │ └─────────┘ │      │
│   └─────────────┘           └─────────────┘           │ ┌─────────┐ │      │
│                                                        │ │ Custom  │ │      │
│                                                        │ │ Plugin  │ │      │
│                                                        │ └─────────┘ │      │
│                                                        └─────────────┘      │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                         SEMANTIC KERNEL                                      │
│   ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐    │
│   │  Kernel  │  │ Services │  │ Plugins  │  │ Memory   │  │ Planners │    │
│   └──────────┘  └──────────┘  └──────────┘  └──────────┘  └──────────┘    │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                         AZURE OPENAI                                         │
│   ┌──────────────────┐  ┌──────────────────┐  ┌──────────────────┐         │
│   │  Chat Completion │  │    Embeddings    │  │    Fine-tuned    │         │
│   │     (GPT-4)      │  │  (ada-002)       │  │     Models       │         │
│   └──────────────────┘  └──────────────────┘  └──────────────────┘         │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. MCP Server Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                            MCP CLIENT                                        │
│              (Copilot Studio / Custom Agent / Claude)                        │
└───────────────────────────────────┬─────────────────────────────────────────┘
                                    │
                              JSON-RPC 2.0
                         (stdio / HTTP / SSE)
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                            MCP SERVER                                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   ┌──────────────────────────────────────────────────────────────────────┐  │
│   │                       SERVER INSTANCE                                 │  │
│   │   Name: "my-server"    Version: "1.0.0"                               │  │
│   │                                                                       │  │
│   │   Capabilities: { tools: {}, resources: {}, prompts: {} }            │  │
│   └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                          TOOLS                                       │   │
│   │   (Functions the agent can execute)                                  │   │
│   │                                                                      │   │
│   │   ┌────────────────┐  ┌────────────────┐  ┌────────────────┐       │   │
│   │   │  query_data    │  │  create_item   │  │  send_email    │       │   │
│   │   │  ────────────  │  │  ────────────  │  │  ────────────  │       │   │
│   │   │  Input Schema  │  │  Input Schema  │  │  Input Schema  │       │   │
│   │   │  Description   │  │  Description   │  │  Description   │       │   │
│   │   └────────────────┘  └────────────────┘  └────────────────┘       │   │
│   │                                                                      │   │
│   │   Protocol Messages:                                                 │   │
│   │   • tools/list → Returns tool definitions                           │   │
│   │   • tools/call → Executes tool with arguments                       │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                        RESOURCES                                     │   │
│   │   (Data sources the agent can read)                                  │   │
│   │                                                                      │   │
│   │   ┌────────────────┐  ┌────────────────┐  ┌────────────────┐       │   │
│   │   │ db://schema/*  │  │ file://docs/*  │  │ api://status   │       │   │
│   │   │ ────────────── │  │ ────────────── │  │ ────────────── │       │   │
│   │   │ Database       │  │ Documentation  │  │ System Status  │       │   │
│   │   │ Schemas        │  │ Files          │  │ Data           │       │   │
│   │   └────────────────┘  └────────────────┘  └────────────────┘       │   │
│   │                                                                      │   │
│   │   Protocol Messages:                                                 │   │
│   │   • resources/list → Returns resource URIs                          │   │
│   │   • resources/read → Returns resource content                       │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                         PROMPTS                                      │   │
│   │   (Reusable prompt templates)                                        │   │
│   │                                                                      │   │
│   │   ┌────────────────┐  ┌────────────────┐                            │   │
│   │   │ analyze_code   │  │ summarize_doc  │                            │   │
│   │   │ ────────────── │  │ ────────────── │                            │   │
│   │   │ Arguments:     │  │ Arguments:     │                            │   │
│   │   │ - code         │  │ - document     │                            │   │
│   │   │ - language     │  │ - length       │                            │   │
│   │   └────────────────┘  └────────────────┘                            │   │
│   │                                                                      │   │
│   │   Protocol Messages:                                                 │   │
│   │   • prompts/list → Returns prompt templates                         │   │
│   │   • prompts/get → Returns rendered prompt                           │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                       EXTERNAL SERVICES                                      │
│   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│   │   Database   │  │  File System │  │  REST APIs   │  │   Email      │  │
│   └──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘  │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 5. RAG (Retrieval-Augmented Generation) Pattern

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          RAG PIPELINE                                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│                            INDEXING PHASE (Offline)                          │
│   ┌──────────────────────────────────────────────────────────────────────┐  │
│   │                                                                       │  │
│   │  ┌─────────┐   ┌─────────┐   ┌─────────┐   ┌─────────────────────┐  │  │
│   │  │Documents│──▶│ Chunk   │──▶│ Embed   │──▶│    Vector Index     │  │  │
│   │  │ (Source)│   │ (Split) │   │ (Model) │   │  (Azure AI Search)  │  │  │
│   │  └─────────┘   └─────────┘   └─────────┘   └─────────────────────┘  │  │
│   │                                                                       │  │
│   │  Example:                                                             │  │
│   │  "Azure Virtual Machines provide..."  →  [0.12, -0.34, 0.56, ...]   │  │
│   │                                                                       │  │
│   └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│                            QUERY PHASE (Online)                              │
│   ┌──────────────────────────────────────────────────────────────────────┐  │
│   │                                                                       │  │
│   │  ┌─────────┐                                                         │  │
│   │  │  User   │                                                         │  │
│   │  │  Query  │                                                         │  │
│   │  └────┬────┘                                                         │  │
│   │       │                                                               │  │
│   │       ▼                                                               │  │
│   │  ┌─────────────────────────────────────────────────────────────────┐│  │
│   │  │                      RETRIEVAL                                   ││  │
│   │  │                                                                   ││  │
│   │  │  Query: "How do I resize a VM?"                                  ││  │
│   │  │              │                                                    ││  │
│   │  │              ▼                                                    ││  │
│   │  │  ┌───────────────────┐    ┌───────────────────┐                 ││  │
│   │  │  │   Embed Query     │    │   Hybrid Search   │                 ││  │
│   │  │  │  [0.15, -0.32...]│───▶│  • Vector (ANN)   │                 ││  │
│   │  │  └───────────────────┘    │  • Keyword (BM25) │                 ││  │
│   │  │                           │  • Semantic Rank  │                 ││  │
│   │  │                           └─────────┬─────────┘                 ││  │
│   │  │                                     │                            ││  │
│   │  │                                     ▼                            ││  │
│   │  │                           ┌───────────────────┐                 ││  │
│   │  │                           │  Top-K Documents  │                 ││  │
│   │  │                           │  (Most Relevant)  │                 ││  │
│   │  │                           └───────────────────┘                 ││  │
│   │  └─────────────────────────────────────────────────────────────────┘│  │
│   │                                     │                                │  │
│   │                                     ▼                                │  │
│   │  ┌─────────────────────────────────────────────────────────────────┐│  │
│   │  │                      AUGMENTATION                                ││  │
│   │  │                                                                   ││  │
│   │  │  ┌─────────────────────────────────────────────────────────────┐││  │
│   │  │  │  System: You are a helpful assistant. Use the context below.│││  │
│   │  │  │                                                              │││  │
│   │  │  │  Context:                                                    │││  │
│   │  │  │  [1] To resize an Azure VM, navigate to...                  │││  │
│   │  │  │  [2] Azure VMs support both vertical and horizontal...      │││  │
│   │  │  │  [3] Before resizing, ensure the new size is available...   │││  │
│   │  │  │                                                              │││  │
│   │  │  │  Question: How do I resize a VM?                            │││  │
│   │  │  └─────────────────────────────────────────────────────────────┘││  │
│   │  └─────────────────────────────────────────────────────────────────┘│  │
│   │                                     │                                │  │
│   │                                     ▼                                │  │
│   │  ┌─────────────────────────────────────────────────────────────────┐│  │
│   │  │                       GENERATION                                 ││  │
│   │  │                                                                   ││  │
│   │  │  ┌───────────────┐    ┌────────────────────────────────────────┐││  │
│   │  │  │   LLM (GPT-4) │───▶│  "To resize an Azure VM, follow these │││  │
│   │  │  │               │    │   steps: 1. Go to the Azure portal... │││  │
│   │  │  │               │    │   [1][2]. Make sure to check size     │││  │
│   │  │  │               │    │   availability in your region [3]."   │││  │
│   │  │  └───────────────┘    └────────────────────────────────────────┘││  │
│   │  └─────────────────────────────────────────────────────────────────┘│  │
│   │                                                                       │  │
│   └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 6. Agent Governance Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        GOVERNANCE LAYERS                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   ┌──────────────────────────────────────────────────────────────────────┐  │
│   │                    IDENTITY LAYER                                     │  │
│   │   ┌────────────────────────────────────────────────────────────────┐ │  │
│   │   │               MICROSOFT ENTRA AGENT ID                          │ │  │
│   │   │   • Unique identity for each agent                              │ │  │
│   │   │   • Service principal authentication                            │ │  │
│   │   │   • Managed identity support                                    │ │  │
│   │   │   • Audit trail for agent actions                              │ │  │
│   │   └────────────────────────────────────────────────────────────────┘ │  │
│   └──────────────────────────────────────────────────────────────────────┘  │
│                                    │                                         │
│                                    ▼                                         │
│   ┌──────────────────────────────────────────────────────────────────────┐  │
│   │                    POLICY LAYER                                       │  │
│   │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌───────────┐  │  │
│   │   │ Conditional │  │     DLP     │  │ Sensitivity │  │   Cost    │  │  │
│   │   │   Access    │  │  Policies   │  │   Labels    │  │  Limits   │  │  │
│   │   │             │  │             │  │             │  │           │  │  │
│   │   │ Who can     │  │ What data   │  │ Information │  │ Budget    │  │  │
│   │   │ use agents  │  │ can flow    │  │ protection  │  │ controls  │  │  │
│   │   └─────────────┘  └─────────────┘  └─────────────┘  └───────────┘  │  │
│   └──────────────────────────────────────────────────────────────────────┘  │
│                                    │                                         │
│                                    ▼                                         │
│   ┌──────────────────────────────────────────────────────────────────────┐  │
│   │                    CONTROL LAYER                                      │  │
│   │   ┌────────────────────────────────────────────────────────────────┐ │  │
│   │   │               COPILOT CONTROL SYSTEM                            │ │  │
│   │   │                                                                  │ │  │
│   │   │   ┌──────────────────────────────────────────────────────────┐ │ │  │
│   │   │   │  Agent Management                                         │ │ │  │
│   │   │   │  • Enable/disable agents per user/group                   │ │ │  │
│   │   │   │  • Approve/reject agent deployments                       │ │ │  │
│   │   │   │  • Configure agent permissions                            │ │ │  │
│   │   │   └──────────────────────────────────────────────────────────┘ │ │  │
│   │   │                                                                  │ │  │
│   │   │   ┌──────────────────────────────────────────────────────────┐ │ │  │
│   │   │   │  Data Governance                                          │ │ │  │
│   │   │   │  • Control data sources agents can access                 │ │ │  │
│   │   │   │  • Manage external connections                            │ │ │  │
│   │   │   │  • Configure grounding data permissions                   │ │ │  │
│   │   │   └──────────────────────────────────────────────────────────┘ │ │  │
│   │   │                                                                  │ │  │
│   │   │   ┌──────────────────────────────────────────────────────────┐ │ │  │
│   │   │   │  Monitoring & Compliance                                  │ │ │  │
│   │   │   │  • Usage analytics and reporting                          │ │ │  │
│   │   │   │  • eDiscovery support                                     │ │ │  │
│   │   │   │  • Compliance dashboards                                  │ │ │  │
│   │   │   └──────────────────────────────────────────────────────────┘ │ │  │
│   │   └────────────────────────────────────────────────────────────────┘ │  │
│   └──────────────────────────────────────────────────────────────────────┘  │
│                                    │                                         │
│                                    ▼                                         │
│   ┌──────────────────────────────────────────────────────────────────────┐  │
│   │                    ADMIN CENTERS                                      │  │
│   │   ┌─────────────────────┐  ┌─────────────────────┐                   │  │
│   │   │  M365 Admin Center  │  │ Power Platform Admin│                   │  │
│   │   │  ─────────────────  │  │ ───────────────────│                   │  │
│   │   │  • Agent catalog    │  │  • Environment mgmt │                   │  │
│   │   │  • User assignment  │  │  • Connector policy │                   │  │
│   │   │  • License mgmt     │  │  • DLP enforcement  │                   │  │
│   │   │  • Usage reports    │  │  • Cost analytics   │                   │  │
│   │   └─────────────────────┘  └─────────────────────┘                   │  │
│   └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 7. Development & Deployment Flow

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                     DEVELOPMENT → DEPLOYMENT FLOW                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   DEVELOPMENT PHASE                                                          │
│   ════════════════                                                          │
│                                                                              │
│   ┌───────────┐    ┌───────────┐    ┌───────────┐    ┌───────────┐        │
│   │  Design   │───▶│   Code    │───▶│   Test    │───▶│  Iterate  │        │
│   │           │    │           │    │           │    │           │        │
│   │ • Define  │    │ • Write   │    │ • F5      │    │ • Fix     │        │
│   │   scope   │    │   agent   │    │   debug   │    │   issues  │        │
│   │ • Plan    │    │ • Build   │    │ • Test    │    │ • Enhance │        │
│   │   arch    │    │   plugins │    │   locally │    │   features│        │
│   └───────────┘    └───────────┘    └───────────┘    └─────┬─────┘        │
│                                                              │              │
│                                                              ▼              │
│   STAGING PHASE                                                              │
│   ═════════════                                                              │
│                                                                              │
│   ┌───────────┐    ┌───────────┐    ┌───────────┐                          │
│   │  Deploy   │───▶│ Validate  │───▶│  Review   │                          │
│   │ to Azure  │    │           │    │           │                          │
│   │           │    │ • Test    │    │ • Code    │                          │
│   │ • Bicep/  │    │   with    │    │   review  │                          │
│   │   Terraform│    │   team    │    │ • Security│                          │
│   │ • App Svc │    │ • UAT     │    │   scan    │                          │
│   └───────────┘    └───────────┘    └─────┬─────┘                          │
│                                            │                                │
│                                            ▼                                │
│   PRODUCTION PHASE                                                           │
│   ════════════════                                                          │
│                                                                              │
│   ┌───────────┐    ┌───────────┐    ┌───────────┐    ┌───────────┐        │
│   │  Publish  │───▶│ Configure │───▶│  Monitor  │───▶│  Maintain │        │
│   │           │    │ Governance│    │           │    │           │        │
│   │ • Teams   │    │           │    │ • App     │    │ • Updates │        │
│   │   App     │    │ • Entra   │    │   Insights│    │ • Patches │        │
│   │   Catalog │    │ • DLP     │    │ • Alerts  │    │ • Scale   │        │
│   │ • M365    │    │ • Costs   │    │ • Usage   │    │ • Optimize│        │
│   │   Admin   │    │           │    │   reports │    │           │        │
│   └───────────┘    └───────────┘    └───────────┘    └───────────┘        │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 8. Decision Tree: Choosing Agent Type

```
                              START
                                │
                                ▼
                    ┌───────────────────────┐
                    │ Do you need custom    │
                    │ orchestration logic?  │
                    └───────────┬───────────┘
                                │
                   ┌────────────┴────────────┐
                   │                         │
                  YES                        NO
                   │                         │
                   ▼                         ▼
        ┌─────────────────────┐   ┌─────────────────────┐
        │ Do you need a       │   │ Do you need to      │
        │ custom LLM or       │   │ call external APIs? │
        │ fine-tuned model?   │   └──────────┬──────────┘
        └──────────┬──────────┘              │
                   │              ┌──────────┴──────────┐
          ┌───────┴───────┐     │                      │
         YES              NO    YES                    NO
          │               │      │                      │
          ▼               ▼      ▼                      ▼
   ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
   │   CUSTOM    │ │   CUSTOM    │ │ DECLARATIVE │ │ DECLARATIVE │
   │   ENGINE    │ │   ENGINE    │ │   AGENT     │ │   AGENT     │
   │   + BYOM    │ │   AGENT     │ │ + PLUGINS   │ │ (Basic)     │
   └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘

   Complex        Multi-step     Standard          Simple Q&A
   reasoning,     workflows,     API calls,        Knowledge-
   custom models  memory, tools  integrations      based chat
```

---

*Architecture Diagrams v1.0 | DW-104 Training Reference*
